# The Software Architect Elevator

書名：軟體架構師全方位提升指南 ( The Software Architect Elevator - Redefining the Architect's Role in the Digital Enterprise )

出版社：O'Reilly

# 何謂架構師

架構師 ( Architect ) 在軟體開發領域中是個令人難以理解的職位，就如同書中開頭說的：

**『架構師的工作既令人感到興奮也具有相當的挑戰性；但不少經理人與技術人員認為架構師只是領著高薪，活在象牙塔，說著不切實際的概念與目標，並強加於人，更常使得專案進程延宕。』**

**『在傳統企業尋求 IT 轉型時，IT 架構師已成為最為吃香的專業人士；但諷刺的是，不少擁有世界級軟體與系統架構的軟體公司，卻沒有架構師一職。』**

架構師看似重要，但又似乎不重要，那麼架構師究竟是什麼職位，又負責甚麼樣的職責。

### 存在但也不存在

架構師在一個專案中不存在於明確的職位，也就是沒有架構師一職專案也能推行，但架構師的職能卻又必須關注專案的一切，也就是若有架構師，則專案的任何一處都可能與架構師有關；就如同書中用『架構師不是什麼』一詞說明，架構師他並沒辦法被明確定義，倘若明確定義職能，就會發現其實架構師與其他職位重疊：

+ **資深開發者**：架構師確實也擁有資深開發的水平，但相比於明星開發者的深度，架構師更重視廣度。
+ **救火隊**：架構師關注整體，因此也會須重視整體的問題與回饋，固然是能解決突發異常，但更重視其問題產生的系統性影響和長久解決方案。
+ **專案經理**：架構師的議題與解決往往是根源軟體的底層、系統的基礎，若要使其架構能正常推動，除了需配合專案進程、掌握人員技術，這也使得架構師具備一定的專案管理知識與技能，但相比於專案經理人，架構師更著重於提供建議和配合進度推展技術。
+ **科學家**：架構師面對問題，也需具有模型與系統的思考方式，並撰寫統整與撰寫文獻，這也使得架構師具有科學家的知識與能力，但其差異在於科學家負責發散 ( 化簡為繁 )，架構師負責收斂 ( 化繁為簡 )。

也正如上所述，架構師本質具有這四種職位的職能，亦表示架構師能相反的降為這四個職位處理相應問題，反之也可從這四者中提升為架構師或從這四者中選擇一位擔任部份職能的架構師；這也是為何架構師不一定存在，倘若不是需要其全面的能力，專案中的其他職位也能根據職能做到部分架構師的職能。

### 需求外的需求

若開發人員是負責處理專案的功能需求，那架構師是負責處理專案的非功能需求，亦或被定義為專案特性，例如可執行性、擴展性、維護性、安全性等；這些需求並非不會被寫入功能需求中，只是除非軟體偏重某個特性，例如防護軟體的功能需求必會牽扯到安全性，否則一般並不會被視為需要重視的特性，並寫入開發需求的文件中。

然而，這些不被重視的特性，卻往往是牽連系統核心問題的根基，例如開發人員的設計原則差異；從各方面去分析與評估系統，提出必須遵循的設計原則、專案結構、技術基礎，便是架構師的負責的需求。

**『幸福的家庭都是相似的，不幸的家庭各有各的不幸』**
> from 安娜卡列尼娜

需求可以明確定義，因為存在明確的目標，那依據目標逐步分析與評估便可清楚匯出需求的藍圖，然而需求外的需求是很難明確的目標，因為若不實際碰上議題便無法構成目標，雖然可依據過往經驗來規劃，但倖存者偏差、黑天鵝永遠都會不間斷出現，甚者架構師間會存在不同的需求方向與議題處理方式；這也是為何架構師具有相當的挑戰性，因為不同切入點的架構師，就有不同的處理方式與方案，各有各的精闢與精彩之處。

### 有價也無價

一位開發人員的價值若在於根據時程完成項目，一位架構師的價值就在於如何維持專案的特性，而維持並非一人之責，更是整個團隊整體的技術方向，如何持續完善這方向便能體現架構師的價值，亦如同書中所提的觀察點：

+ **架構師會把點連起來**：系統是一群獨立又相依的盒子，架構師須檢視這一切並確保依賴的清晰。
+ **架構師懂得權衡利弊得失**：系統設計並不是只有優點沒有缺點，架構師必須懂得在優缺中選擇，已持續維持目標的特性。
+ **架構師注重的不只是產品**：開發團隊是為了產品存在，架構師是為了團隊存在，產品固然重要，但更需關注負責發展產品的團隊。
+ **架構師要提出策略**：不論是技術、商業方面，架構師需在兩著間構成橋梁並提出策略，確保商業與技術間的轉換不會因為雙方的己見而爭執。
+ **架構師與複雜度奮戰**：開發需求猶如疊床架屋，是持續發散且堆積複雜度，架構師則需懂得減少複雜度來收斂，以維持目標的特性。
+ **架構師能交**：架構師也是開發人員，面對技術現實並逐步實踐，從自身經驗得到議題與回饋，避免落入『掌控一切』的錯覺。

若說架構師的價值有限，那多半團隊仍在完成功能這方向上掙扎，而倘若團隊已擺脫功能需求而進入持續維護產品與增加需求時，架構師的價值便容易體現，正如同書中提到的：

**『架構師如同變革的代言人』**

若團隊不能正視需求開發中累積起的技術債，若團隊不尋求根本的解決專案運作問題，那麼架構師便沒有出面的必要。

### 完善職責

書中對於架構師的腳色應如何完善職責，提出了一下建議與說明：

+ 架構師升降梯
> 往返於頂樓與引擎室之間

一間公司、部門是由不同職位的人組成，有人負責業務、有人負責規劃、有人負責開發，而組織、團隊規模越大，則職位細分會不斷細緻，人與人的隔閡越大；這導致溝通容易出現傳達錯誤，導致因理解不同產生的結果偏差，而協助樓層間溝通與轉譯內容，避免解果偏差產生可說是架構師的第一職責；就如同搭乘升降梯從頂樓 ( 業務 ) 與引擎室 ( 開發 ) 往返，彙整需求、技術的可能性，提出雙方都能理解的建議。

有趣的是，若用升降梯比喻架構師價值，則不應該用高度衡量，而是涉足的樓層來論價值。

+ 明星架構師
> 架構師扮演多重角色

架構師並不是只負責畫設計圖的人，而是實際負責將設計圖繪製出後，將之實踐與運作的人，最終踏上名為『大師』的最高舞台；然而，在不同的組織、團隊中，有不同的氛圍、不同的議題，就好比電影的世界觀與劇本各有各的走向，架構師需在其中尋找自身的角色定位，從而架構出升降梯，完善其工作環境並逐步推展獲取得來的目標。

+ 活在一階導數中的架構師
> 在持續變動的世界中，你目前所在的位置並不是很有意義

在微積分有這麼一說『一階微分求斜率、二階微分求反曲』，而斜率亦可表示變動幅度，反曲亦可表示變動提升幅度；倘若任何系統或軟體必然存在的特性，便是變動率或稱版本更新，那怕是一次性開發的專案都可能存在短期內的版本變更；而架構師必需應對的第二職責就是讓變動率可控，現今稱為 DevOps ( 開發運維 ) 的職位便是專擅持續整合、持續部屬的規劃與設計，最終追求自動化的開發、部屬環境；架構師透過 DevOps 的規劃，除可控制版本變更時機、提升變更效率、產品的穩定性，並從而衡量產品的各項特性，藉此獲得與完善目標特性。

+ 企業架構師或企業中的架構師？
> 象牙塔的較高與較低樓層

書中有個有趣的標題『技術從火星來，業務從金星來』，期待戰神瑪爾斯 ( Mars ) 理解女神維納斯 ( Venus ) 是徒勞的，反之亦然，這其實也表示了組織、團隊中必然的溝通隔閡；企業架構師一指企業架構的規劃師，往往不涉足基層技術，流於圖紙設計，並難以價值驅動架構推展，而其問題本源，便是企業架構師未能重視技術本質，忽略實務層面的轉換負擔；而企業中的架構師，是指在組織、團隊中搭建了自身的升降梯，從而擔任墨丘利 ( Mercury ) 的職責，並審視組織、團隊整體，將其中的流程化繁為簡，讓架構控管一切可能的變動。

+ 三角架構師
> 三腳凳不會晃

一位架構師必需擁有三隻腳來站穩，才能邁向成功 **技能 ( Skill )** 、**影響 ( Impact )**、**領導 ( Leadership )**；而優秀的架構師，更能透過良性循環來提升這三者，藉由 **瞭解專業技能**、**指導他人**、**發揮效用** 在循環自身的技能配養，以此反覆最終站穩自身的三隻腳。

+ 作決策
> 決定不去作決定是一種決策

一粒灰塵導致的系統當機機率有多高？不論這數字多低，一旦存在風險就存在決策來解決，而架構師的每個設計都是基於需求外的已知或可能風險產生出來，因必然得對每個設計作好決策；然而就如書中引用 Martin Fowler 所提的 **架構師最重要的工作之一就是消除軟體設計的不可逆性**，亦即讓決策存在選項，讓必需作的決策依據現況變更決策。

+ 質疑每件事
> 不提問，不會變聰明

解決問題必需先面對問題，面對問題必需先找到問題，架構師是負責非功能需求，而這些需求來源可以是已知的異常，或來源於系統分析與設計需求中令人質疑之處；因此，架構師必需懂得在面對質疑點時，事實提問以尋求設計者的思考邏輯，並從中找出盲點，並分析回應來統整出適當的設計方案。


# 何謂架構

架構 ( Architecture ) 在軟體領域中是個難以定義的存在，誠如書中所述：

**『架構的定義幾乎與職業的架構師一樣多』**

在 [Pattern-Oriented Software Architecture](../software-engineering/architecture_pattern.md) 一書中對架構是這樣解釋：

**『Architecture is a concept.』**

相同議題、相同知識，有多少種人就有多少種解釋，而架構僅是一種概念，即便可以從大量的概念中抽出架構樣式 ( Architecture Pattern )，但這仍然是個概念，更是不同人來解讀就有不同的看法，這也呼應了本書所述。

### 架構的層次

對於架構的概念差異看法，融合書中描述與個人觀點，共有如下層次：

+ 軟體架構 ( Software Architecture )，單一軟體、專案、服務本身所遵循的概念，如相依性反轉原則 ( Dependency Inversion Principle )
+ 系統架構 ( System Architecture )，複數軟體、專案、服務構成的系統所需遵循的概念，如微服務架構 ( Microservice Architecture )
+ 企業架構 ( Enterprise Architecture )，整合複數系統來維持企業運作的原則，如基礎設施即程式碼 ( Infrastructure as Code )
    - 架構委員 ( Architecture Committee )，規範軟體、系統架構的組織所需遵循的原則，如敏捷開發 ( Agile Development )
    - 架構團隊 ( Architecture Team )，參與架構設計、規範的團隊原則，如編碼風格 ( Coding Style )

誠如書中所述，一般說明架構會聯想到軟體與系統的特性，但從企業、組織的來看，負責建構架構的架構師，亦有著架構運作；就個人過往經驗來描述，架構師在設計的是軟體、系統間的溝通，但若將層次提升至企業，則更需注重人與人間的溝通，並設計其中的關聯與服務，讓其整體運作不因此停頓與斷裂，而這正是 DevOps 的設計觀點。

### 架構的特性

對於架構的特性，書中如此描述：

+ 原則驅動決策
    - 架構是權衡 ( Trade-offs ) 後的結果，不存在最好，只有最適
    - 架構講求概念 ( Concept ) 的完整性、系統 ( System ) 的一致性
+ 垂直凝聚力
    - 架構是層次 ( Layer ) 一致，並非只有軟體、硬體內，更需考量兩者間的規劃
    - 垂直並非僅有技術，亦需包括業務，非需求性的功能，往往來自業務的文字描述

### 企業中的架構

書中對於大型組織中的架構，列舉了一下需要做到的事項：

+ 辨識架構
> 尋找決策

**『任何有意義的決策，都會存在缺點』**

架構的產生，是基於某個原則而制定的決策；倘若一個架構中不存在基於目標性的決策，倘若經過權衡的架構不存在缺點，則該架構不具意義；因為架構是基於對非功能性需求的假設與預期，制定的一個原則，但既然制定原則做出了決策權衡，則有好處必有壞處。

+ 推銷選項
> 猶豫不決時，有幾個選項可選是件好事

需求會增加，也會變動，當設計師說出『需求沒這麼寫』時，大概率可以確定這軟體的擴展性設計沒被考量，也能預期變動來時會帶來的重構風險；若需求存在擴展性設計議題，同樣的問題也存在於非需求性的功能中，而架構的項目來自於假設與預期，那麼更會存在假設失當、錯誤預判的可能；因此，架構必然存在應對未知與變動的選項，以此避免不可逆決策的存在 ( 寫死的參數的演算法 )，並盡可能的推遲選項的選擇時間 ( 抽象化變數與運作流程 )；同樣的選項設計也適用於業務決策，對於架構的設計也需考量行銷方案的轉變，逐步提高軟體的選項，降低企業、系統結構根本性改變時帶來的重構風險。

+ 系統皆完美
> 那要看它被設計來做什麼

系統是設計來長久應對複雜問題，故能正常運作的系統必是完美，理論上。

越是複雜的系統，其本身即是個有序複雜性( organnized complexity ) 的存在，即使系統結構明確，其長期運作仍存在執行中的不可預期風險；即使設計回饋循環來輔助，亦可能因為正循環導致的爆炸性異常，更可能因為系統效應 ( 蝴蝶效應 ) 導致複不可預風險發生。

但也正因為系統複雜且不可預期，更應準備好系統的地圖來了解系統整體與概觀，並依循架構原則來修正系統行為，逐次降低不可預期風險，修正系統抗拒的慣性。

+ 無懼寫碼
> 沒有工具的支援，用設計不良的語言來撰寫程式並不好玩

對維運團隊來說，採用組態 ( Configuration ) 設置遠比轉寫程式碼來得安全，也可以避免因為程式撰寫錯誤導致系統異常；在企業觀點來看，維運穩定、成本降低是好的工作習慣，因此避免撰寫程式碼導致風險增加是必然的狀況；然而，即使不去撰寫程式碼，系統建置仍需有組態定義，倘若為了更有效與穩定的建置、驗證、規劃，將組態配置、動態改變依循基礎設施即程式碼 ( IaC、Infrastructure as Code ) 原則，則勢必要求維運人員需適度的撰寫程式。

在開發、維運團隊中，懼怕撰寫程式碼是常見的問題，即使長年身處開發一線的資深人員，也會因為重構而感到厭煩與懼怕；因此，如何制定開發架構來降低人員的恐懼，避免因畏懼而讓團隊裹足不前，亦是架構師的職責之一。

本書主要探討的企業架構、IT 架構，更接近開發架構與維運架構的組成，因此對於基礎設施即程式碼 ( IaC、Infrastructure as Code ) 原則看法並不太認同，反而更認為應該是基礎設施即組態 ( IaC、Infrastructure as Configuration )；就個人觀點與經驗，兩者皆可，但因 Developer、DevOps 的職責偏向，更加認可基礎設施即程式碼的運用。

+ 什麼都不砍，將與殭屍共存
> 然後它們會把你的腦子給吃了

技術債是個永遠的議題，無論是基於錯誤的需求、開發進度差異、人員交接不完整等任何原因，一旦技術債累積成包袱系統 ( Legacy System )，就是比考量如何處置該系統；但如前面所述，系統即使存在不可預期風險，但依舊抗拒改變，因為改變本身就是製造風險；更由於懼怕寫碼這項產業人員問題，導致包袱系統逐漸累積，逐漸成為耗損系統效能的怪物。

在開發、維運團隊中，都各自存在不同的技術債，也都有著各自的理由讓此些包袱系統存活；因此，架構需能夠考量版本、過時的預期準備，並將汰換的時程納入考量，從軟體、系統、企業層面規劃汰除目標與原則，並改善團隊文化讓重構造成的恐懼感降低。

+ 別派人做機器的事
> 把所有事情自動化；沒辦法自動化的，將其變成自助式服務

在多數情況下，系統的運作是一個無限重複且循環的事情，那怕是為了穩定性，遵循開發、測式、部屬反覆驗證程序，這也不是適合由人去執行的機械行為；人員的工作應該更加著重在研究、創意、設計之上，讓系統穩定的驗證、運作，則應設計自動化來完成，若所需自動化中存在動因，則設計依循選項內容的自助式服務；因此，架構需能夠應對自動化、自助式服務，並配合開發運維 ( DevOps ) 的需要設計。

+ 當軟體淹沒世界，讓版本控制一切
> 當基礎建設皆軟體化，你需要用軟體開發者的方式思考

版本控制是一個有趣的技術，藉由版本流程的定義，讓軟體從開發、維運的自動化一體適用在不同的執行環境，諸如開發 ( DEV )、整合測試 ( SIT )、品質驗證 ( QA )、用戶適用 ( UAT )、產品環境 ( PRD )；也如書中所述，當基礎設施即程式碼完善，並讓軟體定義了全部 ( SDX ) 之後，則開發維運 ( DevOps ) 的設計已然成形後，在符合持續整合 ( CI ) 與持續部屬 ( CD ) 的原則下讓系統可穩定的持續驗證，並逐步讓開發人員的自信心增長；因此，架構需能夠遵循版本控制的概念，從軟體、系統、企業架構的運作皆符合版本的推進與變更運作。

+ A4 紙不會扼殺創意
> 堅固平台給開發人員一張白紙

白紙有限制尺寸，卻沒限制創作內容；對軟體開發來說，限制環境並不會讓內容被扼殺，只是限制了內容可用的工具，這即是[平台即服務 ( PaaS、Platform as a Service )](https://zh.wikipedia.org/wiki/%E5%B9%B3%E5%8F%B0%E5%8D%B3%E6%9C%8D%E5%8A%A1) 的定義，亦是本書中所闡述的，架構要制定環境規範與自動化程序，讓開發人員有充分發展的環境，並從 IaaS、PaaS、SaaS、FaaS 來規劃與設計，讓平台單元能藉由分層 ( Layered ) 部屬，讓系統在各環境中的組合與依賴關係明確。

+ 資訊科技 ( IT ) 世界是平的
> 沒有地圖，所有的路看來都有希望

工欲善其事，必先利其器，而這些利器，便是分布在技術地圖上的諸國；若從架構的觀點來設計團隊、組織所需要的服務，就會注意到除了軟體本身所需的第三方外，諸多服務、虛擬化技術需要大量的第三方技術支持；因此，架構需要定義自身的第三方地圖，並審視其必要性，避免過度依賴，也避閉門造車。

+ 咖啡店不用二階段提交
> 排隊時學學分散式系統設計

如果軟體是一套模擬咖啡店點餐、製作的服務流程，那麼架構就是讓這流程存在的咖啡店，或著說真實世界；此段著重一個現實世界的咖啡店運作來說明一個概念，現實世界是個平行的世界，有多少客人就有多少需求，有多少員工就有多少執行程序，大家都是獨立的個體，因此諸多事情發生皆是在同一時間；因此，在現在的架構的運行時，絕大多數是依存在分散式系統的環境中，那怕是軟體架構也有不少會著重在並行運行來規劃與設計，而如何規劃與運用分散式系統，更可有效的提升系統的運作效率，但也需注意分散系統本身的並行議題與風險。
